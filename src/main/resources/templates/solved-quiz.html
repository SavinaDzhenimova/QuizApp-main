<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">

<head>
    <th:block th:replace="~{fragments/commons::head}"></th:block>
    <link rel="stylesheet" href="/css/solved-quiz-styles.css">
    <link rel="stylesheet" href="/css/quiz-styles.css">
    <title>It's Quiz Time</title>
</head>

<body>

    <header th:replace="~{fragments/commons::header}"></header>

    <main>
      <div class="quiz-container">
        <h2 th:text="'Куиз в категория ' + ${solvedQuiz.categoryName}"></h2>

        <div class="quiz-info">
            <p>Резултат:
                <span th:text="${solvedQuiz.score}"></span>/<span th:text="${solvedQuiz.maxScore}"></span>
            </p>
            <p>Решен на: <span th:text="${#temporals.format(solvedQuiz.solvedAt, 'dd.MM.yyyy г. HH:mm')}"></span></p>
        </div>

        <div class="question-pages">
          <div th:each="question : ${solvedQuiz.questions}" class="question-page">

            <h3 th:text="${question.questionText}" class="question-text"></h3>

            <div class="answers">
              <label class="answer-option" th:each="option, aIdx : ${question.options}">
                <input type="radio"
                       th:name="'answers[' + ${question.id} + ']'"
                       th:value="${option}"
                       required>
                <span th:text="${option}"></span>
              </label>
            </div>
          </div>
        </div>

        <div class="pagination-buttons">
          <button type="button" id="prevBtn">⬅ Предишен</button>
          <button type="button" id="nextBtn">Следващ ➡</button>
        </div>
        <a th:href="@{/users/quizzes}" class="btn-start">Обратно към всички</a>
      </div>
    </main>

    <footer th:replace="~{fragments/commons::footer}"></footer>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const questions = document.querySelectorAll(".question-page");
        const nextBtn = document.getElementById("nextBtn");
        const prevBtn = document.getElementById("prevBtn");

        let current = 0;

        function showQuestion(index) {
          questions.forEach((q, i) => {
            q.classList.toggle("active", i === index);
          });

          prevBtn.style.display = index === 0 ? "none" : "inline-block";
          nextBtn.style.display = index === questions.length - 1 ? "none" : "inline-block";
        }

        nextBtn.addEventListener("click", () => {
          if (current < questions.length - 1) current++;
          showQuestion(current);
        });

        prevBtn.addEventListener("click", () => {
          if (current > 0) current--;
          showQuestion(current);
        });

        showQuestion(current);
      });
    </script>
</body>
</html>